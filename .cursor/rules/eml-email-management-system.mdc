---
description: 
globs: 
alwaysApply: false
---
# EML é‚®ä»¶ç®¡ç†ç³»ç»Ÿå¼€å‘è§„èŒƒ

## é¡¹ç›®æ¦‚è¿°

åŸºäº Yudao æ¡†æ¶å¼€å‘çš„ Web ç«¯ EML é‚®ä»¶ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒç”¨æˆ·ä¸Šä¼  ZIP å‹ç¼©åŒ…ï¼Œè‡ªåŠ¨è§£æå…¶ä¸­çš„ .eml æ–‡ä»¶ï¼Œæå–é‚®ä»¶ä¿¡æ¯å¹¶å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œé™„ä»¶å­˜å‚¨åˆ° MinIOï¼Œæä¾›å®Œæ•´çš„é‚®ä»¶æŸ¥çœ‹ã€æœç´¢ã€æ ‡è®°å’Œç®¡ç†åŠŸèƒ½ã€‚

## æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Spring Boot 3.x (åŸºäº Yudao æ¡†æ¶)
- **æ•°æ®æŒä¹…åŒ–**: MyBatis-Plus + MySQL
- **æ–‡ä»¶å­˜å‚¨**: MinIO (é€šè¿‡ yudao-module-infra-file é›†æˆ)
- **é‚®ä»¶è§£æ**: JavaMail API
- **æƒé™ç®¡ç†**: å¤ç”¨ Yudao RBAC æƒé™ç³»ç»Ÿ
- **ä»»åŠ¡è°ƒåº¦**: Spring Task (å¼‚æ­¥å¤„ç†å¤§æ–‡ä»¶è§£æ)

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Vue.js 3.x + Element Plus
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router
- **HTTP å®¢æˆ·ç«¯**: Axios
- **UI ç»„ä»¶**: Element Plus

### éƒ¨ç½²æŠ€æœ¯
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **æ–‡ä»¶å­˜å‚¨**: MinIO æœåŠ¡
- **æ•°æ®åº“**: MySQL 8.0+

## æ¨¡å—ç»“æ„

```
yudao-module-tool/
â”œâ”€â”€ yudao-module-tool-api/
â”‚   â””â”€â”€ src/main/java/cn/iocoder/yudao/module/tool/api/eml/
â”œâ”€â”€ yudao-module-tool-biz/
â”‚   â””â”€â”€ src/main/java/cn/iocoder/yudao/module/tool/
â”‚       â”œâ”€â”€ controller/admin/eml/
â”‚       â”œâ”€â”€ service/eml/
â”‚       â”œâ”€â”€ dal/
â”‚       â”‚   â”œâ”€â”€ dataobject/eml/
â”‚       â”‚   â””â”€â”€ mysql/eml/
â”‚       â””â”€â”€ convert/eml/
â””â”€â”€ sql/
    â””â”€â”€ eml/
```

## æ ¸å¿ƒæ•°æ®æ¨¡å‹

### 1. EmailMessage (é‚®ä»¶ä¸»ä½“)
```sql
CREATE TABLE tool_email_message (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    import_batch_id BIGINT NOT NULL COMMENT 'å¯¼å…¥æ‰¹æ¬¡ID',
    message_id VARCHAR(500) COMMENT 'Message-IDå¤´',
    sender VARCHAR(200) NOT NULL COMMENT 'å‘ä»¶äºº',
    recipients TEXT COMMENT 'æ”¶ä»¶äººåˆ—è¡¨(JSON)',
    cc_recipients TEXT COMMENT 'æŠ„é€åˆ—è¡¨(JSON)',
    bcc_recipients TEXT COMMENT 'å¯†é€åˆ—è¡¨(JSON)',
    subject VARCHAR(1000) COMMENT 'ä¸»é¢˜',
    send_date DATETIME COMMENT 'å‘é€æ—¶é—´',
    receive_date DATETIME COMMENT 'æ¥æ”¶æ—¶é—´',
    content_text LONGTEXT COMMENT 'çº¯æ–‡æœ¬å†…å®¹',
    content_html LONGTEXT COMMENT 'HTMLå†…å®¹',
    original_path VARCHAR(1000) NOT NULL COMMENT 'åŸå§‹æ–‡ä»¶è·¯å¾„',
    attachment_count INT DEFAULT 0 COMMENT 'é™„ä»¶æ•°é‡',
    is_starred BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦æ ‡è®°æ˜Ÿæ ‡',
    creator VARCHAR(64) DEFAULT '',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    updater VARCHAR(64) DEFAULT '',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted BIT(1) DEFAULT 0,
    tenant_id BIGINT DEFAULT 0
);
```

### 2. EmailAttachment (é‚®ä»¶é™„ä»¶)
```sql
CREATE TABLE tool_email_attachment (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    email_message_id BIGINT NOT NULL COMMENT 'é‚®ä»¶ID',
    filename VARCHAR(500) NOT NULL COMMENT 'æ–‡ä»¶å',
    content_type VARCHAR(200) COMMENT 'æ–‡ä»¶ç±»å‹',
    file_size BIGINT COMMENT 'æ–‡ä»¶å¤§å°',
    file_url VARCHAR(1000) NOT NULL COMMENT 'MinIOå­˜å‚¨URL',
    file_path VARCHAR(1000) NOT NULL COMMENT 'MinIOå­˜å‚¨è·¯å¾„',
    creator VARCHAR(64) DEFAULT '',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    deleted BIT(1) DEFAULT 0,
    tenant_id BIGINT DEFAULT 0
);
```

### 3. ImportBatch (å¯¼å…¥æ‰¹æ¬¡)
```sql
CREATE TABLE tool_import_batch (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    batch_name VARCHAR(200) NOT NULL COMMENT 'æ‰¹æ¬¡åç§°',
    zip_filename VARCHAR(500) NOT NULL COMMENT 'ZIPæ–‡ä»¶å',
    status TINYINT NOT NULL COMMENT 'çŠ¶æ€ï¼š1-å¤„ç†ä¸­,2-æˆåŠŸ,3-éƒ¨åˆ†å¤±è´¥,4-å¤±è´¥',
    total_files INT DEFAULT 0 COMMENT 'æ€»æ–‡ä»¶æ•°',
    success_count INT DEFAULT 0 COMMENT 'æˆåŠŸæ•°',
    fail_count INT DEFAULT 0 COMMENT 'å¤±è´¥æ•°',
    start_time DATETIME COMMENT 'å¼€å§‹æ—¶é—´',
    end_time DATETIME COMMENT 'ç»“æŸæ—¶é—´',
    error_message TEXT COMMENT 'é”™è¯¯ä¿¡æ¯',
    creator VARCHAR(64) DEFAULT '',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    tenant_id BIGINT DEFAULT 0
);
```

### 4. ImportErrorLog (å¯¼å…¥é”™è¯¯æ—¥å¿—)
```sql
CREATE TABLE tool_import_error_log (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    import_batch_id BIGINT NOT NULL COMMENT 'å¯¼å…¥æ‰¹æ¬¡ID',
    file_path VARCHAR(1000) NOT NULL COMMENT 'é”™è¯¯æ–‡ä»¶è·¯å¾„',
    error_type VARCHAR(100) COMMENT 'é”™è¯¯ç±»å‹',
    error_message TEXT NOT NULL COMMENT 'é”™è¯¯è¯¦æƒ…',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    tenant_id BIGINT DEFAULT 0
);
```

## æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

### 1. ZIP æ–‡ä»¶ä¸Šä¼ ä¸è§£ææµç¨‹
```java
@Service
public class EmlImportService {
    
    @Async
    public void processZipFile(MultipartFile zipFile, Long userId) {
        // 1. åˆ›å»ºå¯¼å…¥æ‰¹æ¬¡è®°å½•
        // 2. è§£å‹ZIPæ–‡ä»¶åˆ°ä¸´æ—¶ç›®å½•
        // 3. é€’å½’æ‰«æ.emlæ–‡ä»¶
        // 4. é€ä¸ªè§£æ.emlæ–‡ä»¶
        // 5. æå–é™„ä»¶å¹¶ä¸Šä¼ åˆ°MinIO
        // 6. ä¿å­˜é‚®ä»¶æ•°æ®åˆ°æ•°æ®åº“
        // 7. æ›´æ–°æ‰¹æ¬¡çŠ¶æ€
        // 8. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    }
    
    private void parseEmlFile(File emlFile, String relativePath, Long batchId) {
        // ä½¿ç”¨JavaMailè§£æEMLæ–‡ä»¶
        // æå–é‚®ä»¶å¤´ã€æ­£æ–‡ã€é™„ä»¶
        // å¤„ç†å­—ç¬¦ç¼–ç é—®é¢˜
        // é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
    }
}
```

### 2. MinIO æ–‡ä»¶å­˜å‚¨é›†æˆ
```java
@Component
public class EmlFileService {
    
    @Autowired
    private FileApi fileApi; // ä½¿ç”¨Yudaoçš„æ–‡ä»¶API
    
    public String uploadAttachment(byte[] content, String filename, String contentType) {
        // é€šè¿‡Yudaoçš„FileApiä¸Šä¼ é™„ä»¶åˆ°MinIO
        // è¿”å›æ–‡ä»¶è®¿é—®URL
    }
    
    public void deleteAttachment(String filePath) {
        // åˆ é™¤MinIOä¸­çš„é™„ä»¶æ–‡ä»¶
    }
}
```

## API æ¥å£è§„èŒƒ

### 1. é‚®ä»¶ç®¡ç†æ¥å£
```java
@RestController
@RequestMapping("/admin-api/tool/eml")
public class EmlController {
    
    @PostMapping("/upload-zip")
    @Operation(summary = "ä¸Šä¼ ZIPå‹ç¼©åŒ…è¿›è¡ŒEMLå¯¼å…¥")
    public CommonResult<Long> uploadZip(@RequestParam("file") MultipartFile file);
    
    @GetMapping("/page")
    @Operation(summary = "åˆ†é¡µæŸ¥è¯¢é‚®ä»¶åˆ—è¡¨")
    public CommonResult<PageResult<EmailMessageRespVO>> getEmailMessagePage(@Valid EmailMessagePageReqVO pageReqVO);
    
    @GetMapping("/{id}")
    @Operation(summary = "è·å–é‚®ä»¶è¯¦æƒ…")
    public CommonResult<EmailMessageRespVO> getEmailMessage(@PathVariable("id") Long id);
    
    @PutMapping("/{id}/toggle-star")
    @Operation(summary = "åˆ‡æ¢é‚®ä»¶æ˜Ÿæ ‡çŠ¶æ€")
    public CommonResult<Boolean> toggleStar(@PathVariable("id") Long id);
    
    @GetMapping("/attachment/{attachmentId}/download")
    @Operation(summary = "ä¸‹è½½é™„ä»¶")
    public void downloadAttachment(@PathVariable("attachmentId") Long attachmentId, HttpServletResponse response);
    
    @DeleteMapping("")
    @Operation(summary = "æ‰¹é‡åˆ é™¤é‚®ä»¶")
    public CommonResult<Boolean> deleteEmailMessages(@RequestBody List<Long> ids);
}
```

### 2. å¯¼å…¥ç®¡ç†æ¥å£
```java
@RestController
@RequestMapping("/admin-api/tool/eml/import")
public class EmlImportController {
    
    @GetMapping("/batches")
    @Operation(summary = "æŸ¥è¯¢å¯¼å…¥æ‰¹æ¬¡åˆ—è¡¨")
    public CommonResult<PageResult<ImportBatchRespVO>> getImportBatches(@Valid ImportBatchPageReqVO pageReqVO);
    
    @GetMapping("/errors/{batchId}")
    @Operation(summary = "æŸ¥è¯¢å¯¼å…¥é”™è¯¯æ—¥å¿—")
    public CommonResult<List<ImportErrorLogRespVO>> getImportErrors(@PathVariable("batchId") Long batchId);
}
```

## å‰ç«¯ç»„ä»¶è®¾è®¡

### 1. é‚®ä»¶åˆ—è¡¨é¡µé¢ (EmailList.vue)
```vue
<template>
  <div class="app-container">
    <!-- æœç´¢è¡¨å• -->
    <el-form :model="queryParams" ref="queryFormRef" :inline="true">
      <el-form-item label="ä¸»é¢˜" prop="subject">
        <el-input v-model="queryParams.subject" placeholder="è¯·è¾“å…¥ä¸»é¢˜" />
      </el-form-item>
      <el-form-item label="å‘ä»¶äºº" prop="sender">
        <el-input v-model="queryParams.sender" placeholder="è¯·è¾“å…¥å‘ä»¶äºº" />
      </el-form-item>
      <el-form-item label="åŸå§‹è·¯å¾„" prop="originalPath">
        <el-input v-model="queryParams.originalPath" placeholder="è¯·è¾“å…¥è·¯å¾„" />
      </el-form-item>
      <el-form-item label="æ˜¯å¦æ˜Ÿæ ‡" prop="isStarred">
        <el-select v-model="queryParams.isStarred">
          <el-option label="å…¨éƒ¨" value="" />
          <el-option label="å·²æ ‡è®°" :value="true" />
          <el-option label="æœªæ ‡è®°" :value="false" />
        </el-select>
      </el-form-item>
    </el-form>
    
    <!-- é‚®ä»¶åˆ—è¡¨è¡¨æ ¼ -->
    <el-table :data="emailList" v-loading="loading">
      <el-table-column type="selection" width="55" />
      <el-table-column label="æ˜Ÿæ ‡" width="60">
        <template #default="{ row }">
          <el-button 
            :icon="row.isStarred ? Star : StarFilled" 
            @click="toggleStar(row)"
            text
          />
        </template>
      </el-table-column>
      <el-table-column prop="subject" label="ä¸»é¢˜" min-width="200" show-overflow-tooltip />
      <el-table-column prop="sender" label="å‘ä»¶äºº" width="150" />
      <el-table-column prop="sendDate" label="å‘é€æ—¶é—´" width="150" />
      <el-table-column prop="attachmentCount" label="é™„ä»¶" width="60" />
      <el-table-column prop="originalPath" label="åŸå§‹è·¯å¾„" min-width="200" show-overflow-tooltip />
      <el-table-column label="æ“ä½œ" width="120">
        <template #default="{ row }">
          <el-button @click="viewDetail(row)" type="primary" link>æŸ¥çœ‹</el-button>
          <el-button @click="deleteEmail(row)" type="danger" link>åˆ é™¤</el-button>
        </template>
      </el-table-column>
    </el-table>
  </div>
</template>
```

### 2. é‚®ä»¶è¯¦æƒ…é¡µé¢ (EmailDetail.vue)
```vue
<template>
  <div class="email-detail">
    <!-- é‚®ä»¶å¤´ä¿¡æ¯ -->
    <el-card class="email-header">
      <div class="header-info">
        <h2>{{ emailDetail.subject }}</h2>
        <p><strong>å‘ä»¶äºº:</strong> {{ emailDetail.sender }}</p>
        <p><strong>æ”¶ä»¶äºº:</strong> {{ emailDetail.recipients?.join(', ') }}</p>
        <p><strong>å‘é€æ—¶é—´:</strong> {{ emailDetail.sendDate }}</p>
        <p><strong>åŸå§‹è·¯å¾„:</strong> {{ emailDetail.originalPath }}</p>
      </div>
    </el-card>
    
    <!-- åŒæ å†…å®¹æ˜¾ç¤º -->
    <div class="content-container">
      <el-row :gutter="20">
        <el-col :span="collapseLeft ? 0 : 12" v-show="!collapseLeft">
          <el-card header="åŸå§‹å†…å®¹">
            <div class="content-controls">
              <el-radio-group v-model="contentType">
                <el-radio-button label="html">HTML</el-radio-button>
                <el-radio-button label="text">çº¯æ–‡æœ¬</el-radio-button>
              </el-radio-group>
              <el-button @click="collapseLeft = true" :icon="ArrowLeft" />
            </div>
            <div v-if="contentType === 'html'" v-html="sanitizedHtml" class="html-content"></div>
            <pre v-else class="text-content">{{ emailDetail.contentText }}</pre>
          </el-card>
        </el-col>
        
        <el-col :span="collapseRight ? 0 : 12" v-show="!collapseRight">
          <el-card header="ç¿»è¯‘å†…å®¹ï¼ˆé¢„ç•™ï¼‰">
            <div class="content-controls">
              <el-button @click="collapseRight = true" :icon="ArrowRight" />
              <el-button @click="resetLayout">é‡ç½®å¸ƒå±€</el-button>
            </div>
            <div class="translation-placeholder">
              <p>ç¿»è¯‘åŠŸèƒ½å¾…å¼€å‘...</p>
              <div v-if="contentType === 'html'" v-html="sanitizedHtml" class="html-content"></div>
              <pre v-else class="text-content">{{ emailDetail.contentText }}</pre>
            </div>
          </el-card>
        </el-col>
        
        <el-col :span="24" v-show="collapseLeft && collapseRight">
          <el-card>
            <div class="expand-controls">
              <el-button @click="expandLeft">æ˜¾ç¤ºåŸå§‹å†…å®¹</el-button>
              <el-button @click="expandRight">æ˜¾ç¤ºç¿»è¯‘å†…å®¹</el-button>
              <el-button @click="resetLayout">æ˜¾ç¤ºåŒæ </el-button>
            </div>
          </el-card>
        </el-col>
      </el-row>
    </div>
    
    <!-- é™„ä»¶åˆ—è¡¨ -->
    <el-card v-if="emailDetail.attachments?.length > 0" header="é™„ä»¶åˆ—è¡¨">
      <el-table :data="emailDetail.attachments">
        <el-table-column prop="filename" label="æ–‡ä»¶å" />
        <el-table-column prop="contentType" label="ç±»å‹" width="120" />
        <el-table-column prop="fileSize" label="å¤§å°" width="100">
          <template #default="{ row }">
            {{ formatFileSize(row.fileSize) }}
          </template>
        </el-table-column>
        <el-table-column label="æ“ä½œ" width="100">
          <template #default="{ row }">
            <el-button @click="downloadAttachment(row)" :icon="Download" />
          </template>
        </el-table-column>
      </el-table>
    </el-card>
  </div>
</template>
```

### 3. ZIP ä¸Šä¼ ç»„ä»¶ (ZipUpload.vue)
```vue
<template>
  <div class="zip-upload">
    <el-card header="å¯¼å…¥EMLé‚®ä»¶">
      <el-upload
        ref="uploadRef"
        :action="uploadUrl"
        :headers="uploadHeaders"
        :before-upload="beforeUpload"
        :on-success="onSuccess"
        :on-error="onError"
        :show-file-list="true"
        :limit="1"
        accept=".zip"
        drag
      >
        <el-icon class="el-icon--upload"><upload-filled /></el-icon>
        <div class="el-upload__text">
          å°†ZIPæ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<em>ç‚¹å‡»ä¸Šä¼ </em>
        </div>
        <template #tip>
          <div class="el-upload__tip">
            åªèƒ½ä¸Šä¼ ZIPæ–‡ä»¶ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è§£æå…¶ä¸­çš„EMLæ–‡ä»¶
          </div>
        </template>
      </el-upload>
    </el-card>
    
    <!-- å¯¼å…¥å†å² -->
    <el-card header="å¯¼å…¥å†å²" class="mt-4">
      <el-table :data="importBatches" v-loading="batchLoading">
        <el-table-column prop="batchName" label="æ‰¹æ¬¡åç§°" />
        <el-table-column prop="zipFilename" label="ZIPæ–‡ä»¶" />
        <el-table-column prop="status" label="çŠ¶æ€" width="100">
          <template #default="{ row }">
            <el-tag :type="getStatusType(row.status)">
              {{ getStatusText(row.status) }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="successCount" label="æˆåŠŸ" width="80" />
        <el-table-column prop="failCount" label="å¤±è´¥" width="80" />
        <el-table-column prop="createTime" label="åˆ›å»ºæ—¶é—´" width="150" />
        <el-table-column label="æ“ä½œ" width="120">
          <template #default="{ row }">
            <el-button v-if="row.failCount > 0" @click="viewErrors(row)" type="warning" link>
              æŸ¥çœ‹é”™è¯¯
            </el-button>
          </template>
        </el-table-column>
      </el-table>
    </el-card>
  </div>
</template>
```

## æƒé™é…ç½®

### èœå•æƒé™é…ç½®
```sql
-- EMLé‚®ä»¶ç®¡ç†èœå•
INSERT INTO system_menu (name, permission, type, sort, parent_id, path, icon, component, status) VALUES
('EMLé‚®ä»¶ç®¡ç†', '', 1, 10, 1264, 'eml', 'email', 'tool/eml/index', 0),
('é‚®ä»¶æŸ¥è¯¢', 'tool:eml:query', 3, 1, (SELECT id FROM system_menu WHERE permission = '' AND name = 'EMLé‚®ä»¶ç®¡ç†'), '', '', '', 0),
('é‚®ä»¶å¯¼å…¥', 'tool:eml:import', 3, 2, (SELECT id FROM system_menu WHERE permission = '' AND name = 'EMLé‚®ä»¶ç®¡ç†'), '', '', '', 0),
('é‚®ä»¶åˆ é™¤', 'tool:eml:delete', 3, 3, (SELECT id FROM system_menu WHERE permission = '' AND name = 'EMLé‚®ä»¶ç®¡ç†'), '', '', '', 0),
('é™„ä»¶ä¸‹è½½', 'tool:eml:download', 3, 4, (SELECT id FROM system_menu WHERE permission = '' AND name = 'EMLé‚®ä»¶ç®¡ç†'), '', '', '', 0);
```

## é…ç½®è¦æ±‚

### application.yml é…ç½®
```yaml
# EMLå¯¼å…¥é…ç½®
yudao:
  eml:
    import:
      temp-dir: /tmp/eml-import  # ä¸´æ—¶æ–‡ä»¶ç›®å½•
      max-file-size: 500MB       # æœ€å¤§ZIPæ–‡ä»¶å¤§å°
      max-eml-files: 10000       # å•æ¬¡æœ€å¤§EMLæ–‡ä»¶æ•°é‡
      thread-pool-size: 5        # è§£æçº¿ç¨‹æ± å¤§å°
      cleanup-temp-files: true   # æ˜¯å¦è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶
```

### MinIO é…ç½®è¦æ±‚
å‚è€ƒç°æœ‰çš„ [application-local.yaml](mdc:yudao-server/src/main/resources/application-local.yaml) æ–‡ä»¶ï¼Œç¡®ä¿ MinIO é…ç½®æ­£ç¡®ï¼š

```yaml
yudao:
  file:
    config:
      - platform: minio
        domain: http://127.0.0.1:9000
        bucket: yudao
        access-key: yudaoadmin
        access-secret: yudao123456
        endpoint: http://127.0.0.1:9000
```

## éƒ¨ç½²é…ç½®

### Docker Compose é…ç½®
```yaml
version: '3.8'
services:
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: password
      MYSQL_DATABASE: ruoyi-vue-pro
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  minio:
    image: minio/minio:latest
    command: server /data --console-address ":9001"
    environment:
      MINIO_ROOT_USER: yudaoadmin
      MINIO_ROOT_PASSWORD: yudao123456
    ports:
      - "9000:9000"
      - "9001:9001"
    volumes:
      - minio_data:/data

  yudao-server:
    build: .
    ports:
      - "48080:48080"
    depends_on:
      - mysql
      - redis
      - minio
    environment:
      SPRING_PROFILES_ACTIVE: prod
      SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/ruoyi-vue-pro
      SPRING_REDIS_HOST: redis
      YUDAO_FILE_MINIO_ENDPOINT: http://minio:9000

volumes:
  mysql_data:
  minio_data:
```

## å¼€å‘æŒ‡å¯¼åŸåˆ™

### 1. ä»£ç ç»„ç»‡åŸåˆ™
- éµå¾ª Yudao æ¡†æ¶çš„åˆ†å±‚æ¶æ„ï¼šController -> Service -> Mapper
- ä½¿ç”¨ Yudao çš„ç»Ÿä¸€å“åº”æ ¼å¼ CommonResult
- ç»Ÿä¸€å¼‚å¸¸å¤„ç†å’Œé”™è¯¯ç å®šä¹‰
- ä½¿ç”¨ Yudao çš„åˆ†é¡µæŸ¥è¯¢ PageResult

### 2. æ•°æ®å®‰å…¨åŸåˆ™
- HTML å†…å®¹éœ€è¦è¿›è¡Œ XSS é˜²æŠ¤å¤„ç†
- æ–‡ä»¶ä¸Šä¼ éœ€è¦ç±»å‹å’Œå¤§å°é™åˆ¶
- æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨
- æƒé™æ ¡éªŒè´¯ç©¿æ•´ä¸ªä¸šåŠ¡æµç¨‹

### 3. æ€§èƒ½ä¼˜åŒ–åŸåˆ™
- å¤§æ–‡ä»¶å¼‚æ­¥å¤„ç†ï¼Œé¿å…é˜»å¡ç”¨æˆ·æ“ä½œ
- é‚®ä»¶å†…å®¹åˆ†é¡µåŠ è½½
- é™„ä»¶æ‡’åŠ è½½
- æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–

### 4. é”™è¯¯å¤„ç†åŸåˆ™
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- ä¸šåŠ¡å¼‚å¸¸å’Œç³»ç»Ÿå¼‚å¸¸åˆ†ç¦»å¤„ç†
- æ”¯æŒé”™è¯¯é‡è¯•æœºåˆ¶

### 5. æ‰©å±•æ€§åŸåˆ™
- é¢„ç•™ç¿»è¯‘åŠŸèƒ½æ¥å£
- æ”¯æŒå¤šç§é‚®ä»¶æ ¼å¼æ‰©å±•
- æ”¯æŒå¤šç§æ–‡ä»¶å­˜å‚¨åç«¯
- æ”¯æŒé‚®ä»¶å†…å®¹æœç´¢å¼•æ“é›†æˆ

---

**æ–¹æ€»ç‰›é€¼** ğŸš€

